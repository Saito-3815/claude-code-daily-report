# 営業日報システム テスト仕様書

## 1. 概要

### 1.1 目的

本書は営業日報システムの品質を担保するためのテスト仕様を定義する。

### 1.2 テスト範囲

| テスト種別     | 対象               | 実施者    |
| -------------- | ------------------ | --------- |
| 単体テスト     | 各モジュール・関数 | 開発者    |
| 結合テスト     | API・画面連携      | 開発者    |
| システムテスト | システム全体       | QA チーム |
| 受入テスト     | 業務シナリオ       | 発注者    |

### 1.3 テスト環境

| 環境             | 用途                 | URL                     |
| ---------------- | -------------------- | ----------------------- |
| 開発環境         | 単体・結合テスト     | https://dev.example.com |
| ステージング環境 | システム・受入テスト | https://stg.example.com |
| 本番環境         | 本番稼働             | https://www.example.com |

### 1.4 テストデータ

| データ種別 | 件数   | 備考                    |
| ---------- | ------ | ----------------------- |
| 営業担当者 | 20 名  | 上長 5 名、担当者 15 名 |
| 顧客       | 100 社 | 有効 90 社、無効 10 社  |
| 日報       | 500 件 | 各ステータス含む        |

---

## 2. 単体テスト仕様

### 2.1 モデル層テスト

---

#### UT-M-001: Salesperson モデル

| No  | テスト項目                  | 入力値               | 期待結果               |
| --- | --------------------------- | -------------------- | ---------------------- |
| 1   | 正常登録                    | 全必須項目入力       | 登録成功               |
| 2   | 社員番号必須チェック        | employee_code: null  | バリデーションエラー   |
| 3   | 社員番号一意チェック        | 既存の社員番号       | バリデーションエラー   |
| 4   | 氏名必須チェック            | name: null           | バリデーションエラー   |
| 5   | 氏名文字数チェック          | name: 51 文字        | バリデーションエラー   |
| 6   | メール形式チェック          | email: "invalid"     | バリデーションエラー   |
| 7   | メール一意チェック          | 既存のメールアドレス | バリデーションエラー   |
| 8   | 上長関連取得                | manager_id 設定      | 上長情報が取得できる   |
| 9   | 部下一覧取得                | 部下が存在する上長   | 部下リストが取得できる |
| 10  | is_manager 判定（部下あり） | 部下が存在           | true                   |
| 11  | is_manager 判定（部下なし） | 部下が不在           | false                  |

---

#### UT-M-002: Customer モデル

| No  | テスト項目                   | 入力値                  | 期待結果             |
| --- | ---------------------------- | ----------------------- | -------------------- |
| 1   | 正常登録                     | 全必須項目入力          | 登録成功             |
| 2   | 顧客コード必須チェック       | customer_code: null     | バリデーションエラー |
| 3   | 顧客コード一意チェック       | 既存の顧客コード        | バリデーションエラー |
| 4   | 顧客コード文字数チェック     | customer_code: 11 文字  | バリデーションエラー |
| 5   | 顧客名必須チェック           | name: null              | バリデーションエラー |
| 6   | 顧客名文字数チェック         | name: 101 文字          | バリデーションエラー |
| 7   | 郵便番号形式チェック         | postal_code: "1234567"  | バリデーションエラー |
| 8   | 郵便番号形式チェック（正常） | postal_code: "123-4567" | 登録成功             |
| 9   | 有効顧客スコープ             | is_active: true         | 有効顧客のみ取得     |

---

#### UT-M-003: DailyReport モデル

| No  | テスト項目                | 入力値               | 期待結果             |
| --- | ------------------------- | -------------------- | -------------------- |
| 1   | 正常登録                  | 全必須項目入力       | 登録成功             |
| 2   | 報告日必須チェック        | report_date: null    | バリデーションエラー |
| 3   | 営業担当者必須チェック    | salesperson_id: null | バリデーションエラー |
| 4   | 同一日重複チェック        | 同じ担当者・同じ日付 | バリデーションエラー |
| 5   | ステータス初期値          | 新規作成             | status: "draft"      |
| 6   | 訪問件数カウント          | 訪問記録 3 件        | visit_count: 3       |
| 7   | 提出可能判定（訪問あり）  | 訪問記録 1 件以上    | true                 |
| 8   | 提出可能判定（訪問なし）  | 訪問記録 0 件        | false                |
| 9   | 編集可能判定（draft）     | status: "draft"      | true                 |
| 10  | 編集可能判定（submitted） | status: "submitted"  | true                 |
| 11  | 編集可能判定（confirmed） | status: "confirmed"  | false                |

---

#### UT-M-004: VisitRecord モデル

| No  | テスト項目                 | 入力値                | 期待結果             |
| --- | -------------------------- | --------------------- | -------------------- |
| 1   | 正常登録                   | 全必須項目入力        | 登録成功             |
| 2   | 日報 ID 必須チェック       | daily_report_id: null | バリデーションエラー |
| 3   | 顧客 ID 必須チェック       | customer_id: null     | バリデーションエラー |
| 4   | 訪問内容必須チェック       | content: null         | バリデーションエラー |
| 5   | 訪問内容文字数チェック     | content: 2001 文字    | バリデーションエラー |
| 6   | 訪問時刻形式チェック       | visit_time: "25:00"   | バリデーションエラー |
| 7   | 結果列挙値チェック         | result: "invalid"     | バリデーションエラー |
| 8   | 結果列挙値チェック（正常） | result: "negotiating" | 登録成功             |

---

#### UT-M-005: Problem / Plan モデル

| No  | テスト項目           | 入力値                | 期待結果               |
| --- | -------------------- | --------------------- | ---------------------- |
| 1   | 正常登録             | 全必須項目入力        | 登録成功               |
| 2   | 日報 ID 必須チェック | daily_report_id: null | バリデーションエラー   |
| 3   | 内容必須チェック     | content: null         | バリデーションエラー   |
| 4   | 内容文字数チェック   | content: 2001 文字    | バリデーションエラー   |
| 5   | 表示順デフォルト     | display_order: null   | 0 が設定される         |
| 6   | コメント関連取得     | コメント 3 件         | コメントリスト取得可能 |

---

#### UT-M-006: Comment モデル

| No  | テスト項目           | 入力値                      | 期待結果             |
| --- | -------------------- | --------------------------- | -------------------- |
| 1   | 正常登録（Problem）  | commentable_type: "Problem" | 登録成功             |
| 2   | 正常登録（Plan）     | commentable_type: "Plan"    | 登録成功             |
| 3   | 投稿者必須チェック   | salesperson_id: null        | バリデーションエラー |
| 4   | 対象種別必須チェック | commentable_type: null      | バリデーションエラー |
| 5   | 対象 ID 必須チェック | commentable_id: null        | バリデーションエラー |
| 6   | 内容必須チェック     | content: null               | バリデーションエラー |
| 7   | 内容文字数チェック   | content: 1001 文字          | バリデーションエラー |
| 8   | ポリモーフィック関連 | Problem/Plan への関連       | 正しく取得できる     |

---

### 2.2 サービス層テスト

---

#### UT-S-001: AuthService

| No  | テスト項目                     | 入力値                     | 期待結果         |
| --- | ------------------------------ | -------------------------- | ---------------- |
| 1   | ログイン成功                   | 正しい email/password      | トークン発行     |
| 2   | ログイン失敗（メール不正）     | 存在しない email           | 認証エラー       |
| 3   | ログイン失敗（パスワード不正） | 誤った password            | 認証エラー       |
| 4   | ログイン失敗（無効ユーザー）   | is_active: false           | 認証エラー       |
| 5   | トークン検証（有効）           | 有効なトークン             | ユーザー情報取得 |
| 6   | トークン検証（期限切れ）       | 期限切れトークン           | 認証エラー       |
| 7   | トークンリフレッシュ           | 有効なリフレッシュトークン | 新トークン発行   |
| 8   | ログアウト                     | 有効なトークン             | トークン無効化   |
| 9   | ログイン試行制限               | 5 回連続失敗               | アカウントロック |

---

#### UT-S-002: DailyReportService

| No  | テスト項目             | 入力値                | 期待結果             |
| --- | ---------------------- | --------------------- | -------------------- |
| 1   | 日報作成（正常）       | 有効なデータ          | 日報作成成功         |
| 2   | 日報作成（重複日付）   | 既存日付              | エラー（CONFLICT）   |
| 3   | 日報更新（draft）      | status: "draft"       | 更新成功             |
| 4   | 日報更新（submitted）  | status: "submitted"   | 更新成功             |
| 5   | 日報更新（confirmed）  | status: "confirmed"   | エラー（FORBIDDEN）  |
| 6   | 日報提出（訪問あり）   | 訪問記録 1 件以上     | 提出成功             |
| 7   | 日報提出（訪問なし）   | 訪問記録 0 件         | エラー（VALIDATION） |
| 8   | 日報確認（上長）       | 上長ユーザー          | 確認成功             |
| 9   | 日報確認（非上長）     | 一般ユーザー          | エラー（FORBIDDEN）  |
| 10  | 日報削除（draft）      | status: "draft"       | 削除成功             |
| 11  | 日報削除（submitted）  | status: "submitted"   | エラー（FORBIDDEN）  |
| 12  | 自分の日報取得         | scope: "own"          | 自分の日報のみ       |
| 13  | 部下日報取得（上長）   | scope: "subordinates" | 部下の日報含む       |
| 14  | 部下日報取得（非上長） | scope: "subordinates" | 自分の日報のみ       |

---

#### UT-S-003: CommentService

| No  | テスト項目                 | 入力値       | 期待結果            |
| --- | -------------------------- | ------------ | ------------------- |
| 1   | コメント投稿（上長）       | 上長ユーザー | 投稿成功            |
| 2   | コメント投稿（非上長）     | 一般ユーザー | エラー（FORBIDDEN） |
| 3   | コメント投稿（自分の部下） | 部下の日報   | 投稿成功            |
| 4   | コメント投稿（他部署）     | 他部署の日報 | エラー（FORBIDDEN） |
| 5   | コメント削除（本人）       | 投稿者本人   | 削除成功            |
| 6   | コメント削除（他人）       | 投稿者以外   | エラー（FORBIDDEN） |

---

## 3. 結合テスト仕様

### 3.1 API 結合テスト

---

#### IT-API-001: 認証 API

| No  | テストケース                    | 前提条件                 | 操作             | 期待結果       |
| --- | ------------------------------- | ------------------------ | ---------------- | -------------- |
| 1   | ログイン →API 実行 → ログアウト | 有効なユーザー           | 一連の操作       | 正常完了       |
| 2   | トークン期限切れ後のアクセス    | 期限切れトークン         | API 実行         | 401 エラー     |
| 3   | リフレッシュトークンでの再認証  | 期限切れアクセストークン | リフレッシュ実行 | 新トークン取得 |
| 4   | ログアウト後のアクセス          | ログアウト済み           | API 実行         | 401 エラー     |

---

#### IT-API-002: 日報 API

| No  | テストケース                       | 前提条件     | 操作           | 期待結果                    |
| --- | ---------------------------------- | ------------ | -------------- | --------------------------- |
| 1   | 日報作成 → 訪問記録追加 → 提出     | ログイン済み | 一連の操作     | 正常完了、status: submitted |
| 2   | 日報作成 →Problem/Plan 追加 → 提出 | ログイン済み | 一連の操作     | 正常完了                    |
| 3   | 提出済日報 → 上長コメント → 確認   | 上長ログイン | 一連の操作     | 正常完了、status: confirmed |
| 4   | 確認済日報の編集試行               | 確認済日報   | 更新 API 実行  | 403 エラー                  |
| 5   | 他人の日報へのアクセス             | 一般ユーザー | 他人の日報取得 | 403 エラー                  |
| 6   | 上長による部下日報閲覧             | 上長ログイン | 部下の日報取得 | 正常取得                    |

---

#### IT-API-003: マスタ API

| No  | テストケース                       | 前提条件         | 操作          | 期待結果       |
| --- | ---------------------------------- | ---------------- | ------------- | -------------- |
| 1   | 顧客登録 → 一覧取得 → 詳細取得     | 管理者ログイン   | 一連の操作    | 正常完了       |
| 2   | 顧客登録（一般ユーザー）           | 一般ユーザー     | 登録 API 実行 | 403 エラー     |
| 3   | 営業登録 → 上長設定 → 部下一覧取得 | 管理者ログイン   | 一連の操作    | 正常完了       |
| 4   | 無効化された顧客の一覧除外         | is_active: false | 一覧取得      | 除外されている |

---

### 3.2 画面結合テスト

---

#### IT-SCR-001: ログイン画面

| No  | テストケース     | 操作                                | 期待結果                 |
| --- | ---------------- | ----------------------------------- | ------------------------ |
| 1   | 正常ログイン     | 正しい認証情報入力 → ログインボタン | ダッシュボードへ遷移     |
| 2   | ログイン失敗     | 誤った認証情報入力 → ログインボタン | エラーメッセージ表示     |
| 3   | 未入力でログイン | 空欄でログインボタン                | バリデーションエラー表示 |
| 4   | メール形式エラー | 不正なメール形式入力                | バリデーションエラー表示 |

---

#### IT-SCR-002: ダッシュボード画面

| No  | テストケース         | 前提条件         | 操作           | 期待結果           |
| --- | -------------------- | ---------------- | -------------- | ------------------ |
| 1   | 日報一覧表示         | ログイン済み     | 画面表示       | 自分の日報一覧表示 |
| 2   | 今月の訪問件数表示   | 訪問記録あり     | 画面表示       | 正しい件数表示     |
| 3   | 未読コメント表示     | 未読コメントあり | 画面表示       | 正しい件数表示     |
| 4   | 今日の日報作成ボタン | 当日日報なし     | ボタンクリック | 日報作成画面へ遷移 |
| 5   | 今日の日報作成ボタン | 当日日報あり     | ボタンクリック | 日報編集画面へ遷移 |
| 6   | ページネーション     | 日報 21 件以上   | 次へクリック   | 2 ページ目表示     |

---

#### IT-SCR-003: 日報作成画面

| No  | テストケース               | 前提条件          | 操作             | 期待結果                 |
| --- | -------------------------- | ----------------- | ---------------- | ------------------------ |
| 1   | 訪問記録行追加             | 画面表示          | 行追加ボタン     | 入力行が追加される       |
| 2   | 訪問記録行削除             | 訪問記録 2 行     | 削除ボタン       | 行が削除される           |
| 3   | 顧客選択                   | 顧客マスタあり    | プルダウン選択   | 顧客名が設定される       |
| 4   | 顧客インクリメンタルサーチ | 顧客マスタあり    | 文字入力         | 候補が絞り込まれる       |
| 5   | 下書き保存                 | 入力済み          | 下書き保存ボタン | status: draft で保存     |
| 6   | 提出（訪問あり）           | 訪問記録 1 件以上 | 提出ボタン       | status: submitted で保存 |
| 7   | 提出（訪問なし）           | 訪問記録 0 件     | 提出ボタン       | エラーメッセージ表示     |
| 8   | 自動保存                   | 入力中            | 1 分経過         | 自動で下書き保存される   |
| 9   | Problem 追加               | 画面表示          | 行追加ボタン     | Problem 入力行追加       |
| 10  | Plan 追加                  | 画面表示          | 行追加ボタン     | Plan 入力行追加          |

---

#### IT-SCR-004: 日報詳細画面

| No  | テストケース                   | 前提条件                | 操作                | 期待結果          |
| --- | ------------------------------ | ----------------------- | ------------------- | ----------------- |
| 1   | 日報内容表示                   | 日報あり                | 画面表示            | 全項目正しく表示  |
| 2   | コメント表示                   | コメントあり            | 画面表示            | コメント一覧表示  |
| 3   | コメント投稿（上長）           | 上長ログイン            | コメント入力 → 送信 | コメント追加表示  |
| 4   | コメント投稿欄非表示（非上長） | 一般ユーザー            | 画面表示            | 投稿欄が非表示    |
| 5   | 確認済にするボタン（上長）     | 上長ログイン、submitted | ボタンクリック      | status: confirmed |
| 6   | 編集ボタン表示（本人、未確認） | 本人、draft/submitted   | 画面表示            | 編集ボタン表示    |
| 7   | 編集ボタン非表示（確認済）     | confirmed               | 画面表示            | 編集ボタン非表示  |

---

#### IT-SCR-005: 部下日報一覧画面

| No  | テストケース       | 前提条件         | 操作           | 期待結果               |
| --- | ------------------ | ---------------- | -------------- | ---------------------- |
| 1   | 部下日報一覧表示   | 上長ログイン     | 画面表示       | 部下の日報一覧表示     |
| 2   | 担当者フィルタ     | 部下複数         | 担当者選択     | 選択した担当者のみ表示 |
| 3   | 期間フィルタ       | 日報複数         | 期間指定       | 期間内の日報のみ表示   |
| 4   | ステータスフィルタ | 各ステータスあり | ステータス選択 | 選択ステータスのみ表示 |
| 5   | 詳細リンク         | 日報あり         | 詳細クリック   | 日報詳細画面へ遷移     |

---

#### IT-SCR-006: 顧客マスタ画面

| No  | テストケース                 | 前提条件       | 操作                  | 期待結果             |
| --- | ---------------------------- | -------------- | --------------------- | -------------------- |
| 1   | 顧客一覧表示                 | 顧客データあり | 画面表示              | 有効顧客一覧表示     |
| 2   | 顧客コード検索               | 顧客データあり | コード入力 → 検索     | 部分一致で絞り込み   |
| 3   | 顧客名検索                   | 顧客データあり | 名前入力 → 検索       | 部分一致で絞り込み   |
| 4   | 新規登録ボタン表示（管理者） | 管理者ログイン | 画面表示              | ボタン表示           |
| 5   | 新規登録ボタン非表示（一般） | 一般ユーザー   | 画面表示              | ボタン非表示         |
| 6   | 顧客登録                     | 管理者ログイン | 必須項目入力 → 保存   | 登録成功、一覧に反映 |
| 7   | 顧客登録（重複コード）       | 管理者ログイン | 既存コード入力 → 保存 | エラーメッセージ表示 |

---

## 4. システムテスト仕様

### 4.1 機能テスト

---

#### ST-F-001: 日報業務フロー

| No  | シナリオ                       | 手順                                                                                                                                                                                  | 期待結果                 |
| --- | ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| 1   | 営業担当者の日報作成〜上長確認 | 1. 営業担当者がログイン<br>2. 日報作成画面で訪問記録入力<br>3. Problem/Plan 入力<br>4. 提出<br>5. 上長がログイン<br>6. 部下日報一覧から日報確認<br>7. コメント投稿<br>8. 確認済に変更 | 全手順が正常完了         |
| 2   | 日報の下書き保存と再編集       | 1. 日報作成開始<br>2. 途中で下書き保存<br>3. ログアウト<br>4. 再ログイン<br>5. 下書きから編集再開<br>6. 提出                                                                          | 入力内容が保持されている |
| 3   | 複数日報の一括閲覧             | 1. 上長ログイン<br>2. 部下日報一覧表示<br>3. 期間指定で絞り込み<br>4. 各日報を順次確認                                                                                                | 全日報が正しく表示される |

---

#### ST-F-002: マスタ管理フロー

| No  | シナリオ                   | 手順                                                                                               | 期待結果                 |
| --- | -------------------------- | -------------------------------------------------------------------------------------------------- | ------------------------ |
| 1   | 新規顧客登録〜日報での使用 | 1. 管理者が顧客登録<br>2. 営業担当者がログイン<br>3. 日報作成で新規顧客を選択<br>4. 訪問記録に使用 | 新規顧客が選択可能       |
| 2   | 営業担当者の上長変更       | 1. 管理者が営業の上長を変更<br>2. 新上長がログイン<br>3. 部下日報一覧確認                          | 変更後の部下が表示される |
| 3   | 顧客の無効化               | 1. 管理者が顧客を無効化<br>2. 営業担当者がログイン<br>3. 日報作成画面確認                          | 無効顧客が選択肢に出ない |

---

### 4.2 性能テスト

---

#### ST-P-001: レスポンス時間

| No  | 対象               | 条件                           | 目標値   |
| --- | ------------------ | ------------------------------ | -------- |
| 1   | ログイン           | 同時 10 ユーザー               | 2 秒以内 |
| 2   | ダッシュボード表示 | 日報 100 件                    | 3 秒以内 |
| 3   | 日報一覧取得       | 500 件中 20 件表示             | 2 秒以内 |
| 4   | 日報詳細表示       | 訪問記録 10 件、コメント 20 件 | 2 秒以内 |
| 5   | 日報作成・保存     | 訪問記録 5 件                  | 3 秒以内 |
| 6   | 顧客検索           | 100 件から検索                 | 1 秒以内 |

---

#### ST-P-002: 負荷テスト

| No  | 対象         | 条件                     | 目標値            |
| --- | ------------ | ------------------------ | ----------------- |
| 1   | 同時アクセス | 50 ユーザー同時操作      | エラー率 1%以下   |
| 2   | ピーク時負荷 | 100 ユーザー同時ログイン | 応答遅延 5 秒以内 |
| 3   | 長時間稼働   | 24 時間連続稼働          | メモリリークなし  |

---

### 4.3 セキュリティテスト

---

#### ST-S-001: 認証・認可

| No  | テスト項目           | 手順                            | 期待結果               |
| --- | -------------------- | ------------------------------- | ---------------------- |
| 1   | 未認証アクセス       | トークンなしで API 実行         | 401 エラー             |
| 2   | 改ざんトークン       | 改ざんしたトークンで API 実行   | 401 エラー             |
| 3   | 権限外アクセス       | 一般ユーザーで管理者 API を実行 | 403 エラー             |
| 4   | 他人のデータアクセス | 他人の日報 ID を直接指定        | 403 エラー             |
| 5   | SQL インジェクション | 入力欄に SQL 文を入力           | エスケープされる       |
| 6   | XSS 攻撃             | 入力欄にスクリプトを入力        | エスケープされる       |
| 7   | CSRF 攻撃            | 不正なリクエスト送信            | トークン検証でブロック |

---

#### ST-S-002: パスワード

| No  | テスト項目             | 手順                      | 期待結果             |
| --- | ---------------------- | ------------------------- | -------------------- |
| 1   | パスワードハッシュ化   | DB のパスワードカラム確認 | ハッシュ化されている |
| 2   | パスワード強度チェック | 弱いパスワードで登録      | バリデーションエラー |
| 3   | ログイン試行制限       | 5 回連続失敗              | 15 分間ロック        |

---

### 4.4 ユーザビリティテスト

---

#### ST-U-001: 画面操作性

| No  | テスト項目       | 確認内容                     | 合否基準                     |
| --- | ---------------- | ---------------------------- | ---------------------------- |
| 1   | タブ移動         | 入力項目間のタブ移動         | 論理的な順序で移動           |
| 2   | エンターキー     | フォームでのエンターキー動作 | 期待通りの動作               |
| 3   | エラー表示       | バリデーションエラー表示     | 該当項目の近くに表示         |
| 4   | ローディング表示 | API 通信中の表示             | ローディングインジケータ表示 |
| 5   | 確認ダイアログ   | 削除操作時                   | 確認ダイアログ表示           |

---

#### ST-U-002: レスポンシブ対応

| No  | デバイス   | 画面幅 | 確認項目           |
| --- | ---------- | ------ | ------------------ |
| 1   | PC         | 1920px | 全画面正常表示     |
| 2   | PC         | 1366px | 全画面正常表示     |
| 3   | タブレット | 768px  | レイアウト崩れなし |
| 4   | タブレット | 1024px | レイアウト崩れなし |

---

## 5. 受入テスト仕様

### 5.1 業務シナリオテスト

---

#### UAT-001: 日常業務シナリオ

**シナリオ**: 営業担当者の 1 日の業務

| ステップ | 操作                                     | 確認項目                     |
| -------- | ---------------------------------------- | ---------------------------- |
| 1        | 朝、システムにログイン                   | ダッシュボード表示           |
| 2        | 前日の日報に上長コメントがあることを確認 | 未読コメント表示、内容確認   |
| 3        | 外出先で顧客を訪問                       | -                            |
| 4        | 帰社後、日報作成画面を開く               | 当日日付が設定されている     |
| 5        | 訪問した顧客を選択し、訪問内容を入力     | 顧客が選択できる             |
| 6        | 2 件目の訪問記録を追加                   | 行が追加できる               |
| 7        | 今日の課題（Problem）を入力              | 入力できる                   |
| 8        | 明日の予定（Plan）を入力                 | 入力できる                   |
| 9        | 日報を提出                               | ステータスが「提出済」になる |
| 10       | ログアウト                               | ログアウト完了               |

---

#### UAT-002: 上長業務シナリオ

**シナリオ**: 上長の部下管理業務

| ステップ | 操作                       | 確認項目                           |
| -------- | -------------------------- | ---------------------------------- |
| 1        | システムにログイン         | ダッシュボード表示                 |
| 2        | 部下日報一覧画面を開く     | 部下の日報が表示される             |
| 3        | 本日提出された日報を確認   | ステータス「提出済」でフィルタ可能 |
| 4        | 部下 A の日報詳細を開く    | 訪問記録、Problem、Plan 表示       |
| 5        | Problem にコメントを投稿   | コメントが追加される               |
| 6        | 日報を「確認済」にする     | ステータスが変わる                 |
| 7        | 部下 B の日報も同様に確認  | 正常に処理できる                   |
| 8        | 今週の部下の訪問状況を確認 | 期間フィルタで確認可能             |

---

#### UAT-003: 管理者業務シナリオ

**シナリオ**: マスタメンテナンス業務

| ステップ | 操作                       | 確認項目               |
| -------- | -------------------------- | ---------------------- |
| 1        | 管理者としてログイン       | 管理者メニュー表示     |
| 2        | 新規顧客を登録             | 顧客マスタに追加される |
| 3        | 既存顧客の情報を更新       | 更新が反映される       |
| 4        | 取引終了顧客を無効化       | 一覧から除外される     |
| 5        | 新入社員を営業マスタに登録 | 登録完了               |
| 6        | 新入社員の上長を設定       | 上長との紐付け完了     |
| 7        | 退職者を無効化             | 一覧から除外される     |

---

### 5.2 例外シナリオテスト

---

#### UAT-E-001: エラーハンドリング

| No  | シナリオ               | 操作                     | 期待結果                         |
| --- | ---------------------- | ------------------------ | -------------------------------- |
| 1   | セッションタイムアウト | 30 分放置後に操作        | ログイン画面にリダイレクト       |
| 2   | 二重送信防止           | 提出ボタンを連打         | 1 回だけ処理される               |
| 3   | 同時編集               | 2 端末で同じ日報を編集   | 後から保存した方が反映される     |
| 4   | ネットワークエラー     | 通信切断中に保存         | エラーメッセージ表示、データ保持 |
| 5   | 不正な URL アクセス    | 存在しない ID を直接入力 | 404 ページ表示                   |

---

## 6. テスト管理

### 6.1 テスト実施スケジュール

| フェーズ       | 期間                    | 担当      |
| -------------- | ----------------------- | --------- |
| 単体テスト     | 開発と並行              | 開発者    |
| 結合テスト     | 開発完了後 1 週間       | 開発者    |
| システムテスト | 結合テスト後 2 週間     | QA チーム |
| 受入テスト     | システムテスト後 1 週間 | 発注者    |

### 6.2 合格基準

| テスト種別     | 合格基準                         |
| -------------- | -------------------------------- |
| 単体テスト     | カバレッジ 80%以上、全テストパス |
| 結合テスト     | 全テストケースパス               |
| システムテスト | 重大バグ 0 件、軽微バグ 5 件以下 |
| 受入テスト     | 全シナリオ合格                   |

### 6.3 バグ重要度定義

| 重要度   | 定義                     | 対応期限       |
| -------- | ------------------------ | -------------- |
| Critical | システム停止、データ損失 | 即時対応       |
| High     | 主要機能が使用不可       | 1 営業日以内   |
| Medium   | 機能の一部に問題あり     | 3 営業日以内   |
| Low      | 軽微な不具合、表示崩れ   | リリース前まで |

### 6.4 テスト報告書

各テストフェーズ完了時に以下を報告する。

- 実施日時
- 実施者
- テストケース数（実施/パス/失敗）
- 検出バグ一覧
- 未解決課題
- 総合判定

---

## 7. 変更履歴

| バージョン | 日付       | 変更内容 |
| ---------- | ---------- | -------- |
| 1.0.0      | 2024-01-15 | 初版作成 |
